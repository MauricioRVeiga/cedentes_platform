<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Insights - Gold Credit</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link href="/css/style.css" rel="stylesheet" />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- Navbar (mesma do dashboard) -->
    <nav class="navbar-modern">
      <!-- ... navbar code ... -->
    </nav>

    <main class="main-content">
      <%- contentFor('body') %>

      <div class="insights-container">
        <div class="insights-header">
          <h2><i class="fas fa-robot"></i> Insights IA</h2>
          <p>Análises inteligentes baseadas nos seus dados</p>
        </div>

        <div class="insights-grid">
          <!-- Cartão de Análise de Status -->
          <div class="insight-card">
            <div class="insight-header">
              <i class="fas fa-chart-pie"></i>
              <h3>Distribuição de Status</h3>
            </div>
            <div class="insight-content" id="status-analysis">
              <div class="loading">
                <i class="fas fa-spinner fa-spin"></i>
                Analisando dados...
              </div>
            </div>
          </div>

          <!-- Cartão de Previsões -->
          <div class="insight-card">
            <div class="insight-header">
              <i class="fas fa-crystal-ball"></i>
              <h3>Previsões</h3>
            </div>
            <div class="insight-content" id="predictions">
              <div class="loading">
                <i class="fas fa-spinner fa-spin"></i>
                Gerando previsões...
              </div>
            </div>
          </div>

          <!-- Cartão de Recomendações -->
          <div class="insight-card">
            <div class="insight-header">
              <i class="fas fa-lightbulb"></i>
              <h3>Recomendações</h3>
            </div>
            <div class="insight-content" id="recommendations">
              <div class="loading">
                <i class="fas fa-spinner fa-spin"></i>
                Elaborando recomendações...
              </div>
            </div>
          </div>
        </div>
      </div>

      <%- contentFor('script') %>
      <script>
        async function loadInsights() {
          try {
            const response = await fetch("/insights/analyze", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({
                // Dados para análise
                data: {
                  // Adicionar dados relevantes aqui
                },
              }),
            });

            const data = await response.json();

            if (data.insights) {
              // Atualizar os cartões com os insights
              document.getElementById("status-analysis").innerHTML =
                data.insights;
            }
          } catch (error) {
            console.error("Erro ao carregar insights:", error);
          }
        }

        // Carregar insights quando a página carregar
        document.addEventListener("DOMContentLoaded", loadInsights);
      </script>
    </main>
  </body>
</html>
